<section class="admin-section" aria-labelledby="post-list-heading">
  <div class="container">
    <div class="section-heading text-center" id="post-list-heading">
      <h4>Manage <em>Posts</em></h4>
      <img src="assets/images/line-dec.png" alt="" aria-hidden="true">
      <p>Create, update, or delete blog posts.</p>
    </div>

    <!-- Create/Update Post Form (Hidden by Default) -->
    <div class="form-section" *ngIf="showForm">
      <h5>{{ editingPost ? 'Update Post' : 'Create Post' }}</h5>
      <form (ngSubmit)="editingPost ? updatePost() : createPost()" [attr.aria-label]="editingPost ? 'Update post form' : 'Create post form'">
        <div class="form-group">
          <label for="post-title" class="form-label">Title</label>
          <input id="post-title" type="text" [(ngModel)]="currentPost.title" name="title" class="form-control" placeholder="Enter post title" required aria-required="true">
        </div>
        <div class="form-group">
          <label for="post-content" class="form-label">Content</label>
          <textarea id="post-content" [(ngModel)]="currentPost.content" name="content" class="form-control" placeholder="Enter post content" required aria-required="true"></textarea>
        </div>
        <div class="form-group">
          <label for="post-author" class="form-label">Author</label>
          <input id="post-author" type="text" [(ngModel)]="currentPost.author" name="author" class="form-control" placeholder="Enter author name">
        </div>
        <div class="form-group">
          <label for="post-category" class="form-label">Category</label>
          <select id="post-category" [(ngModel)]="selectedCategoryId" name="categoryId" class="form-control" required aria-required="true">
            <option value="">Select Category</option>
            <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
          </select>
        </div>
        <div class="form-group">
          <label for="post-image" class="form-label">Image</label>
          <input id="post-image" type="file" (change)="onFileSelected($event)" accept="image/*" class="form-control">
          <small *ngIf="uploadedFileUrl" class="form-text">Uploaded: {{ uploadedFileUrl }}</small>
        </div>
        <div class="gradient-button">
          <button type="submit" [disabled]="!selectedCategoryId || !currentPost.title || !currentPost.content" [attr.aria-disabled]="!selectedCategoryId || !currentPost.title || !currentPost.content ? 'true' : 'false'">
            {{ editingPost ? 'Update Post' : 'Create Post' }}
          </button>
          <button type="button" (click)="cancelEdit()" class="cancel-button">Cancel</button>
          <button type="button" *ngIf="selectedFile" (click)="uploadFile()" class="gradient-button">Upload Image</button>
        </div>
      </form>
    </div>

    <!-- Posts Table -->
    <div class="table-section">
      <div class="gradient-button text-center mb-4">
        <button (click)="showCreateForm()" aria-label="Create new post">Create Post</button>
      </div>
      <h5>All Posts</h5>
      <table class="table table-striped table-bordered" aria-describedby="post-list-heading">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Title</th>
            <th scope="col">Author</th>
            <th scope="col">Category</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let post of posts">
            <td>{{ post.id }}</td>
            <td>{{ post.title }}</td>
            <td>{{ post.author || 'Unknown' }}</td>
            <td>{{ post.category?.name || 'Uncategorized' }}</td>
            <td>
              <button class="gradient-button" (click)="editPost(post)" [attr.aria-label]="'Edit post ' + post.title">Update</button>
              <button class="delete-button" (click)="deletePost(post.id)" [attr.aria-label]="'Delete post ' + post.title">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Pagination -->
      <nav class="pagination text-center" aria-label="Post list pagination">
        <div class="border-button">
          <a href="javascript:void(0)" [class.disabled]="page === 0" (click)="onPageChange(page - 1)" role="button" aria-label="Previous page">Previous</a>
        </div>
        <span aria-current="page">Page {{ page + 1 }} of {{ totalPages }}</span>
        <div class="border-button">
          <a href="javascript:void(0)" [class.disabled]="page >= totalPages - 1" (click)="onPageChange(page + 1)" role="button" aria-label="Next page">Next</a>
        </div>
      </nav>
    </div>
  </div>
</section>